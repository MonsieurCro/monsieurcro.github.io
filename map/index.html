<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
		<title>Urbex Map</title>
		<meta name="author" content="MonsieurCro"/>

		<link rel="shortcut icon" href="https://www.google.com/images/branding/product/ico/maps15_bnuw3a_32dp.ico"/>

		<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap"/>
		<script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

		<script type="text/javascript" src="https://api.mapbox.com/mapbox-gl-js/v1.11.1/mapbox-gl.js"></script>
		<link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/v1.11.1/mapbox-gl.css"/>

		<style>
			* {
				outline: none;
				outline-color: transparent;
				-webkit-tap-highlight-color: rgba(255, 255, 255, 0);
				-webkit-touch-callout: none;
				-webkit-user-select: none;
				 -khtml-user-select: none;
				   -moz-user-select: none;
				    -ms-user-select: none;
				     -o-user-select: none;
				        user-select: none;
				-webkit-user-drag: none;
				        user-drag: none;
				-webkit-box-sizing: border-box;
				   -moz-box-sizing: border-box;
				        box-sizing: border-box;
				-webkit-transition: all .3s ease;
			       -moz-transition: all .3s ease;
					    transition: all .3s ease;
				font-family: 'Roboto', Arial, Helvetica, sans-serif;
				font-weight: 400;
				color: #333;
			}
			button, input[type="button"] {
				-webkit-appearance: none;
				   -moz-appearance: none;
				    -ms-appearance: none;
				margin: 0; padding: 0;
				border: none;
				background: none;
				cursor: pointer;
			}
			html {
				overflow-y: auto;
				scrollbar-width: none;
				-ms-overflow-style: none;

				background-color: #333;
			}
			html::-webkit-scrollbar {
				width: 0; height: 0;
				display: none;
			}
			body {
				margin: 0; padding: 0;
				overflow: hidden;
			}
			.modal {
				width: 100%; max-width: 900px; height: 100vh;
				margin: 0 auto;
				background-color: white;
				padding: 3em 1em 1em;
				-webkit-box-shadow: 0 0 0 3px rgba(0, 0, 0, .25);
            		    box-shadow: 0 0 0 3px rgba(0, 0, 0, .25);
            	position: relative;
            	overflow-y: hidden;
			}
			.modal .close, .modal h3.title, .modal .menu {
			    position: absolute;
			    top: 0; bottom: auto;
			    margin: 0;
			    height: 3rem; line-height: 3rem;
			    font-weight: 700;
			}
			/*.modal .close {
			    right: .75rem; left: auto;
			    z-index: 2;
			    font-size: 1.5rem;
			}
			.modal .close:hover {
				transform: rotate(90deg);
			}*/
			.modal h3.title {
				left: 1.5rem; right: auto;
				z-index: 1;
			}
			.modal .menu {
				/*right: calc(.75rem + 2.25rem);*/
				right: .75rem;
			}
			.modal .menu button {
				padding: .25rem .5rem;
				border: 1px solid #EEE;
				border-radius: 2px;
			}
			.modal .menu button.active {
				border-color: #333;
				background-color: #EEE;
			}
			.modal #custom_map {
				width: 100%; height: 100%;
			}
			.mapboxgl-marker {
				background-size: contain;
				background-position: center;
				background-repeat: no-repeat;
			}
			.marker-city {
				border-radius: 0;
				cursor: pointer;
				width: 25px; height: 25px;
				background-image: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJDYXBhXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgNjAgNjAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDYwIDYwOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8cGF0aCBzdHlsZT0iZmlsbDojQjAyNzIxOyIgZD0iTTUzLjc5MiwyOC4wMjhMMzAsOS42ODhMNi4yMDgsMjguMDI4Yy0xLjIyOCwwLjk0Ni0yLjk3NCwwLjgwMS00LjAyOC0wLjMzNWwwLDANCgljLTEuMTk1LTEuMjg3LTEuMDMzLTMuMzIsMC4zNS00LjQwMmwyNS40My0xOS44OTVMMzAsMS41bDIuMDQxLDEuODk2bDI1LjQzLDE5Ljg5NWMxLjM4MywxLjA4MiwxLjU0NSwzLjExNSwwLjM1LDQuNDAybDAsMA0KCUM1Ni43NjYsMjguODI5LDU1LjAyLDI4Ljk3NCw1My43OTIsMjguMDI4eiIvPg0KPHBhdGggc3R5bGU9ImZpbGw6I0IwMjcyMTsiIGQ9Ik01My43OTIsMjguMDI4TDMwLDkuNjg4TDYuMjA4LDI4LjAyOGMtMS4yMjgsMC45NDYtMi45NzQsMC44MDEtNC4wMjgtMC4zMzVsMCwwDQoJYy0xLjE5NS0xLjI4Ny0xLjAzMy0zLjMyLDAuMzUtNC40MDJsMjUuNDMtMTkuODk1TDMwLDEuNWwyLjA0MSwxLjg5NmwyNS40MywxOS44OTVjMS4zODMsMS4wODIsMS41NDUsMy4xMTUsMC4zNSw0LjQwMmwwLDANCglDNTYuNzY2LDI4LjgyOSw1NS4wMiwyOC45NzQsNTMuNzkyLDI4LjAyOHoiLz4NCjxwb2x5Z29uIHN0eWxlPSJmaWxsOiNFMEUxRTI7IiBwb2ludHM9IjMwLDkuNjg4IDcsMjcuNDE3IDcsMjcuNSA3LDU3LjUgNTMsNTcuNSA1MywyNy41IDUzLDI3LjQxNyAiLz4NCjxnPg0KCTxwYXRoIHN0eWxlPSJmaWxsOiNFMEUxRTI7IiBkPSJNNTksNDcuNWMtMC41NTMsMC0xLDAuNDQ4LTEsMXYxaC0xdi0xYzAtMC41NTItMC40NDctMS0xLTFzLTEsMC40NDgtMSwxdjFoLTJjLTAuNTUzLDAtMSwwLjQ0OC0xLDENCgkJczAuNDQ3LDEsMSwxaDJ2M2gtMmMtMC41NTMsMC0xLDAuNDQ4LTEsMXMwLjQ0NywxLDEsMWgydjFjMCwwLjU1MiwwLjQ0NywxLDEsMXMxLTAuNDQ4LDEtMXYtMWgxdjFjMCwwLjU1MiwwLjQ0NywxLDEsMQ0KCQlzMS0wLjQ0OCwxLTF2LTlDNjAsNDcuOTQ4LDU5LjU1Myw0Ny41LDU5LDQ3LjV6IE01Nyw1NC41di0zaDF2M0g1N3oiLz4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRTBFMUUyOyIgZD0iTTcsNTEuNWMwLjU1MywwLDEtMC40NDgsMS0xcy0wLjQ0Ny0xLTEtMUg1di0xYzAtMC41NTItMC40NDctMS0xLTFzLTEsMC40NDgtMSwxdjFIMnYtMQ0KCQljMC0wLjU1Mi0wLjQ0Ny0xLTEtMXMtMSwwLjQ0OC0xLDF2OWMwLDAuNTUyLDAuNDQ3LDEsMSwxczEtMC40NDgsMS0xdi0xaDF2MWMwLDAuNTUyLDAuNDQ3LDEsMSwxczEtMC40NDgsMS0xdi0xaDINCgkJYzAuNTUzLDAsMS0wLjQ0OCwxLTFzLTAuNDQ3LTEtMS0xSDV2LTNIN3ogTTMsNTQuNUgydi0zaDFWNTQuNXoiLz4NCjwvZz4NCjxyZWN0IHg9IjE1IiB5PSIyNi41IiBzdHlsZT0iZmlsbDojNTU2MDgwOyIgd2lkdGg9IjEyIiBoZWlnaHQ9IjgiLz4NCjxyZWN0IHg9IjE1IiB5PSI0MC41IiBzdHlsZT0iZmlsbDojNTU2MDgwOyIgd2lkdGg9IjEyIiBoZWlnaHQ9IjEwIi8+DQo8cmVjdCB4PSIzMyIgeT0iMjYuNSIgc3R5bGU9ImZpbGw6IzU1NjA4MDsiIHdpZHRoPSIxMiIgaGVpZ2h0PSI4Ii8+DQo8cmVjdCB4PSIzMyIgeT0iNDAuNSIgc3R5bGU9ImZpbGw6IzU1NjA4MDsiIHdpZHRoPSIxMiIgaGVpZ2h0PSIxNyIvPg0KPHJlY3QgeD0iMzMiIHk9IjI2LjUiIHN0eWxlPSJmaWxsOiM3MzgzQkY7IiB3aWR0aD0iMTIiIGhlaWdodD0iNiIvPg0KPHJlY3QgeD0iMTUiIHk9IjI2LjUiIHN0eWxlPSJmaWxsOiM3MzgzQkY7IiB3aWR0aD0iMTIiIGhlaWdodD0iMi43NjUiLz4NCjxwb2x5Z29uIHN0eWxlPSJmaWxsOiM3MzgzQkY7IiBwb2ludHM9IjIyLDQ0LjUgMjIsNDAuNSAyMCw0MC41IDIwLDQ0LjUgMTUsNDQuNSAxNSw0Ni41IDIwLDQ2LjUgMjAsNTAuNSAyMiw1MC41IDIyLDQ2LjUgMjcsNDYuNSANCgkyNyw0NC41ICIvPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPC9zdmc+DQo=');
			}
			.marker-urbex {
				border-radius: 0;
				cursor: pointer;
				width: 30px; height: 30px;
				background-image: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJDYXBhXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgNTggNTgiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDU4IDU4OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8bGluZSBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojNTU2MDgwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjEwOyIgeDE9IjI5IiB5MT0iMjgiIHgyPSIyOSIgeTI9IjU3Ii8+DQo8Y2lyY2xlIHN0eWxlPSJmaWxsOiNERDM1MkU7IiBjeD0iMjkiIGN5PSIxNCIgcj0iMTQiLz4NCjxjaXJjbGUgc3R5bGU9ImZpbGw6I0Y3NjM2MzsiIGN4PSIyNCIgY3k9IjEwIiByPSIzIi8+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8L3N2Zz4NCg==');
			}
			.mapboxgl-popup {
				width: calc(100% - 2*1rem); max-width: 250px !important;
			    height: auto; max-height: calc(100% - 2*1rem);
			    overflow: hidden;
			    z-index: 2;
			    /*Fix it*/
			    transform: translate(1rem, 1rem) !important;
			}
			.mapboxgl-popup-tip {
				display: none !important;
			}
			.mapboxgl-popup-close-button {
				top: .25rem; right: .25rem; bottom: auto; left: auto;
			    font-size: 1em; height: 1em; line-height: 0;
			    padding: 2.5px;
			    border-radius: 50%;
			    background-color: #EEE;
			}
			.mapboxgl-popup-close-button:hover {
				color: #EEE;
				background-color: #333;
			}
			.mapboxgl-popup-content {
			    text-align: center;
			    padding: .75rem;
			    border-radius: 1px;
			    -webkit-box-shadow: 0 0 2px 1px rgba(0, 0, 0, .15);
            		    box-shadow: 0 0 2px 1px rgba(0, 0, 0, .15);
			}
			.mapboxgl-popup-content img {
			    width: auto; max-width: 80%;
			    height: auto; max-height: 100%;
			    margin: .25rem auto 0;
			}
			.mapboxgl-popup-content h3 {
			    margin: 0 auto;
			    font-weight: 700;
			}
			.mapboxgl-popup-content .coord {
				margin: 0 auto;
				font-weight: 300;
			}
			.mapboxgl-popup-content p {
				padding-top: .5rem;
    			border-top: 1px solid #EEE;
    			margin: .5rem auto 0;
    			height: auto; max-height: 30vh;
    			overflow-y: auto;
    			scrollbar-width: none;
				-ms-overflow-style: none;
			}
			.mapboxgl-popup-content p::-webkit-scrollbar {
				width: 0; height: 0;
				display: none;
			}
			#version {
				color: #333;
				background-color: white;
				font-size: .5rem;
				padding: .15rem 0 0 .15rem;
				position: absolute;
				bottom: 1rem; right: 1rem; top: auto; left: auto;
				z-index: 999;
			}
		</style>
	</head>
	<body>
		<div class="modal">
			<!--<button type="button" class="close" aria-label="Close">✕</button>-->
			<h3 class="title">Urbex Map</h3>
			<div class="menu">
				<button id="streets" class="active">Streets</button>
				<button id="hybrid">Satellite</button>
			</div>
			<div id="custom_map"></div>
			<div id="version">Last updated on 12/07/2020 • v0.1.7</div>
		</div>

		<script type="text/javascript">
			$(document).ready(function(){
				// https://docs.mapbox.com/mapbox-gl-js/api/markers/

				mapboxgl.accessToken = 'pk.eyJ1IjoibXJjcm8iLCJhIjoiY2tjZ29oZWhrMG0zdDMxbHB0b3J5bmU5ciJ9.MOQlOXhtgBSOccVP48pQfQ';
				
				if (!mapboxgl.supported()){
					alert('Sorry, your browser does not support this dynamic map.');
				} else {
					// Create map
					var map = new mapboxgl.Map({
		      			container: 'custom_map',
				      	style: 'https://api.maptiler.com/maps/streets/style.json?key=RwhwbQ8iAXKzXz4nDnsR',
				      	center: [4.165556, 50.410722],
				      	zoom: 10,
				      	attributionControl: false
				    });

				    // Read markers
					$.getJSON('https://monsieurcro.github.io/map/markers.json', function(data){
						$.each(data.markers, function(i, data){
							
							// Fetch popup content
							var markerContent = '';
							if(data.image.trim().length > 0){ markerContent += '<img src="' + data.image + '" alt="" title=""/>' };
							if(data.name.trim().length > 0){ markerContent += '<h3>' + data.name + '</h3>' };
							if(data.coord.length > 0){ markerContent += '<span class="coord">' + data.coord[0] + ' | ' + data.coord[1] + ' <a href="https://www.google.com/maps/place/' + data.coord[1] + ',' + data.coord[0] + '" target="_blank">🗺️</a></span>' };
							if(data.descr.trim().length > 0){ markerContent += '<p>' + data.descr + '</p>' };
							if(data.link.length > 0){ markerContent += '<p><a href="' + data.link[1] + '" target="_blank">' + data.link[0] + '</a></p>' };

							// Create a DOM element
							var DOMarker = document.createElement('div');
							DOMarker.className = 'mapboxgl-marker marker-' + data.tags[0].toLowerCase();

							// Write markers
							new mapboxgl.Marker(DOMarker, { anchor: 'bottom' })
							.setLngLat(data.coord)
							.setPopup(new mapboxgl.Popup({ offset: 27.5 })
								.setHTML(markerContent)
							)
							.addTo(map); // .togglePopup();
						});

						// Add fullscreen control
						map.addControl(
							new mapboxgl.FullscreenControl()
						);

						// Disable map rotation
						map.dragRotate.disable();
						map.touchZoomRotate.disableRotation();

						// Add geolocate control
						map.addControl(
							new mapboxgl.GeolocateControl({
								positionOptions: {
									enableHighAccuracy: true
								},
								trackUserLocation: true
							})
						);

						// Update style
						$('.menu button').click(function(){
							$('.active').removeClass('active');
							map.setStyle('https://api.maptiler.com/maps/' + $(this).attr('id') + '/style.json?key=RwhwbQ8iAXKzXz4nDnsR');
							$(this).addClass('active');
						});
					});
				};
			});
		</script>
	</body>
</html>